<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>World Values Survey</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="d3.parcoords.css">
  </head>
  <body>
    <div class="custom-menu-wrapper">
        <div class="pure-menu custom-menu custom-menu-top">
            <a href="#" class="pure-menu-heading custom-menu-brand">World Value Surveys</a>
            <a href="#" class="custom-menu-toggle" id="toggle"><s class="bar"></s><s class="bar"></s></a>
        </div>
        <div class="pure-menu pure-menu-horizontal pure-menu-scrollable custom-menu custom-menu-bottom custom-menu-tucked" id="tuckedMenu">
            <ul class="pure-menu-list">
              <li class="pure-menu-item"><a href="#" id="wave2" class="pure-menu-link pure-menu-link--selected">Wave 2 (1990 - 1994)</a></li>
              <li class="pure-menu-item"><a href="#" id="wave3" class="pure-menu-link">Wave 3 (1995 - 1998)</a></li>
              <li class="pure-menu-item"><a href="#" id="wave4" class="pure-menu-link">Wave 4 (1999 - 2004)</a></li>
              <li class="pure-menu-item"><a href="#" id="wave5" class="pure-menu-link">Wave 5 (2005 - 2009)</a></li>
              <li class="pure-menu-item"><a href="#" id="wave5" class="pure-menu-link">Wave 6 (2010 - 2014)</a></li>
            </ul>
        </div>
    </div>

    <div class="main">
      <div id="example" class="parcoords" style="height:800px;"></div>
      <div id="grid"></div>
    </div>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="lib/d3.min.js"></script>
    <script src="lib/d3.parcoords.js"></script>
    <script src="lib/divgrid.js"></script>

    <script id="brushing">
      var blue_to_brown = d3.scale.linear()
        .domain([5, 8])
        .range(["blue", "red"]);

      var color = function(d) { return blue_to_brown(d['Life Satisfaction']); };

      var render = function(csvFile) {

        var parcoords = d3.parcoords()("#example")
          .color(color)
          .alpha(0.4);

        d3.csv(csvFile, function(data) {
          parcoords
            .data(data)
            .render()
            .reorderable()
            .brushMode("1D-axes");

          var grid = d3.divgrid();
          d3.select("#grid")
            .datum(data.slice(0,10))
            .call(grid)
            .selectAll(".row")
            .on({
              "mouseover": function(d) { parcoords.highlight([d]) },
              "mouseout": parcoords.unhighlight
            });

          // update data table on brush event
          parcoords.on("brush", function(d) {
            d3.select("#grid")
              .datum(d.slice(0,10))
              .call(grid)
              .selectAll(".row")
              .on({
                "mouseover": function(d) { parcoords.highlight([d]) },
                "mouseout": parcoords.unhighlight
              });
          });
        });
      }

      render('wave2.csv');

      $('#wave2').on('click', function() {
        render('wave2.csv');
        parcoords.updateAxes();
        $('.pure-menu-link').removeClass('pure-menu-link--selected');
        $(this).addClass('pure-menu-link--selected');
      });

      $('#wave3').on('click', function() {
        render('wave3.csv');
        $('.pure-menu-link').removeClass('pure-menu-link--selected');
        $(this).addClass('pure-menu-link--selected');
      });

      $('#wave4').on('click', function() {
        render('wave4.csv');
        $('.pure-menu-link').removeClass('pure-menu-link--selected');
        $(this).addClass('pure-menu-link--selected');
      });

      $('#wave5').on('click', function() {
        render('wave5.csv');
        $('.pure-menu-link').removeClass('pure-menu-link--selected');
        $(this).addClass('pure-menu-link--selected');
      });

      $('#wave6').on('click', function() {
        render('wave6.csv');
        $('.pure-menu-link').removeClass('pure-menu-link--selected');
        $(this).addClass('pure-menu-link--selected');
      });
    </script>
  </body>
</html>